<!-- Mermaid 다이어그램 지원 -->
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  
  // Mermaid 초기화
  mermaid.initialize({ 
    startOnLoad: true,
    theme: 'default',
    securityLevel: 'loose',
    fontFamily: 'noto-sans-kr, -apple-system, BlinkMacSystemFont, sans-serif',
    themeVariables: {
      primaryColor: '#667eea',
      secondaryColor: '#764ba2',
      tertiaryColor: '#8b7cf8',
      quaternaryColor: '#a78bfa',
    }
  });
  
  // 페이지 로드 완료 후 실행
  document.addEventListener('DOMContentLoaded', async function() {
    // .language-mermaid 클래스를 가진 코드 블록 찾기
    const mermaidBlocks = document.querySelectorAll('pre > code.language-mermaid');
    
    // 각 코드 블록을 mermaid 클래스 pre 태그로 변환
    mermaidBlocks.forEach((codeBlock) => {
      const preElement = codeBlock.parentElement;
      const mermaidContent = codeBlock.textContent;
      
      // 새로운 pre 요소 생성
      const newPre = document.createElement('pre');
      newPre.className = 'mermaid';
      newPre.textContent = mermaidContent;
      
      // 기존 요소를 새 요소로 교체
      preElement.parentNode.replaceChild(newPre, preElement);
    });
    
    // Mermaid 렌더링 실행
    await mermaid.run({
      querySelector: '.mermaid',
    });
  });
</script>